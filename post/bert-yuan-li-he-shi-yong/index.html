
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>BERTåŸç†å’Œä½¿ç”¨ | ä¹¦ç”Ÿæµ·æµ·</title>
<meta name="description" content="æ¸©æ•…è€ŒçŸ¥æ–°">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://aprilspring.github.io/favicon.ico?v=1667029754307">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://aprilspring.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://aprilspring.github.io">
        <img class="avatar" src="https://aprilspring.github.io/images/avatar.png?v=1667029754307" alt="" width="32px" height="32px">
      </a>
      <a href="https://aprilspring.github.io">
        <h1 class="site-title">ä¹¦ç”Ÿæµ·æµ·</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            å…³äº
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
          <h2 class="post-title">BERTåŸç†å’Œä½¿ç”¨</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2019-01-26</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://aprilspring.github.io/tag/UGg7JjI7b/">
                    NLP
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content" v-pre>
            <p>æœ€è¿‘NLPé¢†åŸŸå‘ç”Ÿäº†ä¸€ä»¶å¤§äº‹ï¼Œä¸€ä¸ªå«BERTçš„é¢„è®­ç»ƒæ¨¡å‹æ€èµ·äº†ä¸€åœºé©å‘½å¼çš„é£æ³¢ã€‚åŸºäºè¿™æ®µæ—¶é—´å‚è¯»å¤§ç‰›ä»¬ç²¾ç»†çš„è§£æï¼Œç®€å•æ€»ç»“ä¸‹BERTçš„åŸç†ï¼ˆWhatï¼‰å’Œæ€ä¹ˆåº”ç”¨åˆ°è‡ªå·±çš„æ•°æ®ä¸­ï¼ˆHowï¼‰ã€‚</p>
<h1 id="bertç®€ä»‹">BERTç®€ä»‹</h1>
<h2 id="bert">BERT</h2>
<p>BERTï¼ˆ<strong>B</strong>idirectional <strong>E</strong>ncoder <strong>R</strong>epresentation from <strong>T</strong>ransformersï¼‰ï¼Œæ˜¯è°·æ­ŒAIå›¢é˜Ÿæ–°å‘å¸ƒçš„åº”ç”¨äºNLPé¢†åŸŸçš„æ¨¡å‹ï¼Œåœ¨11é¡¹NLPä»»åŠ¡å‡è·å¾—äº†ç›¸å½“ä¸é”™çš„ç»“æœï¼Œæ–‡ç« äº2018å¹´10æœˆå‘è¡¨ï¼Œå¹¶æä¾›äº†å¼€æºåœ°å€ï¼ˆ https://github.com/google-research/bert ï¼‰ï¼Œè‡´è°¢ğŸ‘ğŸ‘ğŸ‘ã€‚</p>
<h2 id="è¯­æ–™åº“">è¯­æ–™åº“</h2>
<p>Corpus: BooksCorpus (800M words) +  English Wikipedia (2,500M words).</p>
<h2 id="é¢„è®­ç»ƒæ¨¡å‹åŠå‚æ•°">é¢„è®­ç»ƒæ¨¡å‹åŠå‚æ•°</h2>
<p>å¯å‚è€ƒGitHubè¯¦ç»†æ–‡æ¡£ã€‚</p>
<h2 id="bertçš„ä¸»è¦ç‰¹ç‚¹">BERTçš„ä¸»è¦ç‰¹ç‚¹</h2>
<p>Ã˜  ä½¿ç”¨Transformerä½œä¸ºç‰¹å¾æå–å™¨</p>
<p>Ã˜  åŒå‘è¯­è¨€æ¨¡å‹</p>
<p><font color=red>ç”±äºBERTæ˜¯åŸºäºTransformeræ¨¡å‹çš„ï¼Œè€ŒTransformeræ¨¡å‹ä¸»è¦åŸºäºAttentionæœºåˆ¶ï¼Œå› æ­¤å…ˆéœ€è¦äº†è§£ä¸‹Attentionæœºåˆ¶ã€‚</font></p>
<p>â€‹</p>
<!--more-->
<h1 id="attentionæœºåˆ¶">Attentionæœºåˆ¶</h1>
<h2 id="attentionæœºåˆ¶çš„æå‡º">Attentionæœºåˆ¶çš„æå‡º</h2>
<p>Ã˜ æ—©åœ¨Seq2seqåŸºç¡€ä¸Šæå‡ºattentionæœºåˆ¶ï¼Œç°åœ¨æåˆ°çš„Seq2seqå‡æŒ‡åŠ å…¥attentionæœºåˆ¶çš„æ¨¡å‹</p>
<p>Ã˜ Seq2seqæ¨¡å‹ï¼šEncoderå°†æ•´ä¸ªè¾“å…¥å‹ç¼©æˆå›ºå®šé•¿åº¦çš„context vector</p>
<p>Ã˜ Attentionæœºåˆ¶ï¼šè¾“å…¥é’ˆå¯¹ä¸åŒæ—¶åˆ»çš„è¾“å‡ºï¼Œæœ‰ç€ä¸åŒçš„é‡è¦ç¨‹åº¦ï¼ˆå³ç”Ÿæˆå¤šä¸ªcontext vectorï¼‰</p>
<p>Ã˜ é‡ç‚¹ï¼š <strong>å¦‚ä½•è®¡ç®—context vectorï¼Ÿ</strong><br>
<img src="https://aprilspring.github.io/post-images/1667020593472.png" alt="" loading="lazy"></p>
<h2 id="attentionæœºåˆ¶çš„åŸç†">Attentionæœºåˆ¶çš„åŸç†</h2>
<p>Attentionæœºåˆ¶ä¸»è¦ç”¨äºè®¡ç®—è¾“å…¥å¯¹ä¸åŒæ—¶åˆ»è¾“å‡ºçš„å·®å¼‚é‡è¦ç¨‹åº¦ã€‚</p>
<blockquote>
<p>1ï¼‰å¯¹äºå½“å‰æ—¶åˆ»Tçš„è¾“å‡ºytï¼Œé™¤äº†éœ€è¦è®¡ç®—ä¸Šä¸€æ—¶åˆ»çŠ¶æ€St-1ä¹‹å¤–ï¼Œè¿˜éœ€è¦çŸ¥é“Encoderå¯¹ytçš„è´¡çŒ®ç¨‹åº¦Ctï¼›</p>
<p>2ï¼‰åˆ†åˆ«è®¡ç®—Encoderä¸åŒæ—¶åˆ»è¾“å…¥çš„éšè—å±‚çŠ¶æ€hj={h1,h2,â€¦,hT}ä¸Decoder ä¸Šä¸€æ—¶åˆ»çš„éšè—å±‚çŠ¶æ€St-1çš„ç›¸å…³æ€§ï¼Œæ¥è·å–ä¸åŒæ—¶åˆ»hjçš„æƒé‡ï¼Œå³<strong>aij</strong>ã€‚</p>
<p>3ï¼‰ä½¿ç”¨aijä¸hjå¯¹åº”ç›¸ä¹˜ï¼Œå†åŠ å’Œï¼Œå¾—åˆ°æ•´ä½“è¾“å…¥å¯¹å½“å‰æ—¶åˆ»è¾“å‡ºçš„è´¡çŒ®ï¼Œå³<strong>Ct</strong>ã€‚</p>
<p>4ï¼‰é’ˆå¯¹ä¸åŒæ—¶åˆ»è¾“å‡ºï¼ŒCtçš„å†…å®¹æ˜¯ä¸ç›¸åŒçš„ï¼Œä¹Ÿå³ååº”äº†è¾“å…¥å¯¹ä¸åŒæ—¶åˆ»è¾“å‡ºçš„å·®å¼‚æ€§ã€‚</p>
</blockquote>
<figure data-type="image" tabindex="1"><img src="https://aprilspring.github.io/post-images/1667020610538.png" alt="" loading="lazy"></figure>
<h2 id="attentionæœºåˆ¶çš„ç§ç±»">Attentionæœºåˆ¶çš„ç§ç±»</h2>
<p>ä¸»è¦åˆ†ä¸ºä»¥ä¸‹3ç§ï¼š</p>
<p>1.Context-attentionï¼ˆå³Encoder-Decoder Attentionï¼‰</p>
<p>2.Self-attentionï¼ˆEncoderå†…éƒ¨ OR Decoderå†…éƒ¨ï¼‰</p>
<p>3.Multi-head attentionï¼ˆå¯ä»¥æ˜¯åŸºäºContext-attentionçš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åŸºäºSelf-attentionçš„ï¼‰</p>
<p><font color=red>åŸºäºå¯¹Attentionæœºåˆ¶çš„ç†è§£ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹Transformeræ¨¡å‹æ˜¯ä»€ä¹ˆä¸œä¸œã€‚</font></p>
<p>â€‹</p>
<h1 id="transformeræ¨¡å‹">Transformeræ¨¡å‹</h1>
<h2 id="transformeræ¨¡å‹ç®€ä»‹">Transformeræ¨¡å‹ç®€ä»‹</h2>
<p>Transformer æ˜¯ä¸ªå åŠ çš„â€œè‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼ˆSelf Attentionï¼‰â€ï¼Œæ˜¯ç›®å‰ NLP é‡Œæœ€å¼ºçš„ç‰¹å¾æå–å™¨ã€‚å…·ä½“æ¥è¯´ï¼ŒTransformeræ˜¯ä¸€ä¸ªå‡çº§ç‰ˆçš„seq2seqï¼Œä¹Ÿç”±ä¸€ä¸ªencoderå’Œä¸€ä¸ªdecoderç»„æˆçš„ï¼Œä½†æ˜¯encoderå’Œdecoderè¿‡ç¨‹éƒ½ä¸ç”¨RNNï¼Œè€Œä¸”æ¢æˆäº†å¤šä¸ªattentionæœºåˆ¶æ¨¡å‹ã€‚</p>
<p>Ã˜ Encoderï¼šä¸€å…±æœ‰N=6æ¬¡å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯åŒ…å« 2 ä¸ªlayers, åˆ†åˆ«æ˜¯ï¼š</p>
<blockquote>
<p>One multi-head self-attention mechanismï¼ˆä¸ºè¾“å…¥å¥å­å‘é‡çš„æ¯ä¸ªè¯å­¦ä¹ ä¸€ä¸ªæƒé‡ï¼‰</p>
<p>One position-wise fully connected feed-forward network</p>
</blockquote>
<p>Ã˜ Decoderï¼ˆrightï¼‰ï¼šä¸€å…±æœ‰N=6æ¬¡å¾ªç¯ï¼Œæ¯æ¬¡å¾ªç¯åŒ…å«3ä¸ªlayersï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<blockquote>
<p>One multi-head self-attention mechanismï¼ˆå½“å‰ç¿»è¯‘è¯ä¸å·²ç¿»è¯‘å‰æ–‡çš„å…³ç³»ï¼‰</p>
<p>One multi-head context-attention mechanismï¼ˆå½“å‰ç¿»è¯‘è¯ä¸ç¼–ç ç‰¹å¾å‘é‡çš„å…³ç³»ï¼‰</p>
<p>One position-wise fully connected feed-forward network</p>
</blockquote>
<p>Ã˜ æ¯ä¸ªlayeråé¢éƒ½è·Ÿäº†ä¸€ä¸ªadd&amp;normï¼Œå³æ·»åŠ residual connections + layer norm</p>
<h2 id="transformeræ¨¡å‹ç»“æ„">Transformeræ¨¡å‹ç»“æ„</h2>
<figure data-type="image" tabindex="2"><img src="https://aprilspring.github.io/post-images/1667020622708.png" alt="" loading="lazy"></figure>
<h3 id="encoderéƒ¨åˆ†">Encoderéƒ¨åˆ†</h3>
<figure data-type="image" tabindex="3"><img src="https://aprilspring.github.io/post-images/1667020632892.png" alt="" loading="lazy"></figure>
<h3 id="querykeyvalue">Query+Key+Value</h3>
<figure data-type="image" tabindex="4"><img src="https://aprilspring.github.io/post-images/1667020647927.png" alt="" loading="lazy"></figure>
<h3 id="self-attention">Self-attention</h3>
<figure data-type="image" tabindex="5"><img src="https://aprilspring.github.io/post-images/1667020657378.png" alt="" loading="lazy"></figure>
<h3 id="multi-head-attention">Multi-Head Attention</h3>
<figure data-type="image" tabindex="6"><img src="https://aprilspring.github.io/post-images/1667020670414.png" alt="" loading="lazy"></figure>
<h3 id="heads-æ•°ç›®å½±å“">Heads æ•°ç›®å½±å“</h3>
<figure data-type="image" tabindex="7"><img src="https://aprilspring.github.io/post-images/1667020690466.png" alt="" loading="lazy"></figure>
<h3 id="position-embedding">Position embedding</h3>
<figure data-type="image" tabindex="8"><img src="https://aprilspring.github.io/post-images/1667020702984.png" alt="" loading="lazy"></figure>
<h3 id="residual-connections-and-layer-norm">Residual connections and Layer norm</h3>
<figure data-type="image" tabindex="9"><img src="https://aprilspring.github.io/post-images/1667020722805.png" alt="" loading="lazy"></figure>
<h3 id="position-wise-feed-forwardnetwork">Position-wise feed-forwardnetwork</h3>
<p>æ˜¯ä¸€ä¸ªå…¨è¿æ¥ç½‘ç»œï¼Œå¯¹æ¯ä¸ªä½ç½®è¿‡ä¸¤ä¸ªçº¿æ€§å±‚ï¼Œå¹¶ä½¿ç”¨ReLUä½œä¸ºæ¿€æ´»å‡½æ•°ã€‚</p>
<figure data-type="image" tabindex="10"><img src="https://aprilspring.github.io/post-images/1667020768964.png" alt="" loading="lazy"></figure>
<h3 id="decoderéƒ¨åˆ†">Decoderéƒ¨åˆ†</h3>
<figure data-type="image" tabindex="11"><img src="https://aprilspring.github.io/post-images/1667020781847.gif" alt="" loading="lazy"></figure>
<figure data-type="image" tabindex="12"><img src="https://aprilspring.github.io/post-images/1667020793382.gif" alt="" loading="lazy"></figure>
<h3 id="maskedæœºåˆ¶">Maskedæœºåˆ¶</h3>
<p>Transformeræ¨¡å‹ä¸­æ¶‰åŠ2ç§maskï¼š</p>
<p>1.Padding maskç”¨åœ¨æ‰€æœ‰çš„scaled dot-product attention</p>
<blockquote>
<p>ç”±äºæ¯æ¬¡è¾“å…¥çš„å¥å­é•¿åº¦ä¸ä¸€æ ·ï¼Œéœ€è¦å¯¹è¾“å…¥åºåˆ—è¿›è¡Œå¯¹é½ï¼Œä¹Ÿå°±æ˜¯ç»™è¾ƒçŸ­çš„åºåˆ—åé¢å¡«å……0ã€‚ç”±äºå¡«å……åºåˆ—æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼Œattentionæœºåˆ¶ä¸åº”è¯¥æŠŠæ³¨æ„åŠ›æ”¾åœ¨è¿™äº›ä½ç½®ï¼Œå› æ­¤éœ€è¦è¿›è¡Œå¦‚ä¸‹å¤„ç†ï¼šæŠŠè¿™äº›ä½ç½®çš„å€¼åŠ ä¸Šä¸€ä¸ªéå¸¸å¤§çš„è´Ÿæ•°(å¯ä»¥æ˜¯è´Ÿæ— ç©·)ï¼Œè¿™æ ·çš„è¯ï¼Œç»è¿‡softmaxï¼Œè¿™äº›ä½ç½®çš„æ¦‚ç‡å°±ä¼šæ¥è¿‘0ã€‚</p>
</blockquote>
<p>2.Sequence maskç”¨åœ¨decoderçš„self-attention</p>
<blockquote>
<p>ä¸ºäº†ä½¿å¾—Decoderä¸èƒ½çœ‹è§æœªæ¥çš„ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯é’ˆå¯¹ä¸€ä¸ªåºåˆ—ï¼Œåœ¨tæ—¶åˆ»çš„è§£ç è¾“å‡ºåªèƒ½ä¾èµ–äºtæ—¶åˆ»ä¹‹å‰çš„è¾“å‡ºï¼Œè€Œä¸èƒ½ä¾èµ–tæ—¶åˆ»ä¹‹åçš„è¾“å‡ºï¼Œå› æ­¤éœ€è¦è¿›è¡Œä¸€äº›å¤„ç†ï¼Œå°†tæ—¶åˆ»ä¹‹åçš„ä¿¡æ¯éšè—èµ·æ¥ã€‚</p>
</blockquote>
<figure data-type="image" tabindex="13"><img src="https://aprilspring.github.io/post-images/1667020826238.png" alt="" loading="lazy"></figure>
<h3 id="final-linear-and-softmax-layer">Final Linear and Softmax Layer</h3>
<p>Decoderå½“å‰è¾“å‡ºï¼Œç»çº¿æ€§å˜æ¢å’Œsoftmax ï¼Œè·å¾—é¢„æµ‹æ¦‚ç‡æœ€å¤§çš„è¯ï¼Œä½œä¸ºè¾“å‡ºç»“æœã€‚</p>
<figure data-type="image" tabindex="14"><img src="https://aprilspring.github.io/post-images/1667020839223.png" alt="" loading="lazy"></figure>
<h2 id="transformerçš„ä¼˜åŠ¿">Transformerçš„ä¼˜åŠ¿</h2>
<ol>
<li>å¹¶è¡Œè®¡ç®—, æé«˜è®­ç»ƒé€Ÿåº¦</li>
</ol>
<blockquote>
<p>Transformerç”¨attentionä»£æ›¿äº†åŸæœ¬çš„RNNï¼›è€ŒRNNåœ¨è®­ç»ƒçš„æ—¶å€™, å½“å‰stepçš„è®¡ç®—è¦ä¾èµ–äºä¸Šä¸€ä¸ªstepçš„hidden stateçš„ï¼Œè€ŒTransformerä¸ç”¨RNNï¼Œæ‰€æœ‰çš„è®¡ç®—éƒ½å¯ä»¥å¹¶è¡Œè¿›è¡Œï¼Œä»è€Œæé«˜çš„è®­ç»ƒçš„é€Ÿåº¦ã€‚</p>
</blockquote>
<ol start="2">
<li>æ•è·é•¿è·ç¦»ç‰¹å¾</li>
</ol>
<blockquote>
<p>åŸæœ¬çš„RNNé‡Œï¼Œå¦‚æœç¬¬ä¸€å¸§è¦å’Œç¬¬åå¸§å»ºç«‹ä¾èµ–ï¼Œé‚£ä¹ˆç¬¬ä¸€å¸§çš„æ•°æ®è¦ä¾æ¬¡ç»è¿‡ç¬¬äºŒä¸‰å››äº”...ä¹å¸§ä¼ ç»™ç¬¬åå¸§ï¼Œè¿›è€Œäº§ç”ŸäºŒè€…çš„è®¡ç®—ï¼›è€Œåœ¨è¿™ä¸ªä¼ é€’çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ç¬¬ä¸€å¸§çš„æ•°æ®å·²ç»äº§ç”Ÿäº†biasedï¼Œå› æ­¤è¿™ä¸ªäº¤äº’çš„é€Ÿåº¦å’Œå‡†ç¡®æ€§éƒ½æ²¡æœ‰ä¿éšœã€‚è€Œåœ¨Transformerä¸­ï¼Œç”±äºæœ‰self attentionçš„å­˜åœ¨ï¼Œä»»æ„ä¸¤å¸§ä¹‹é—´éƒ½æœ‰ç›´æ¥çš„äº¤äº’ï¼Œä»è€Œå»ºç«‹äº†ç›´æ¥çš„ä¾èµ–ï¼Œæ— è®ºäºŒè€…è·ç¦»å¤šè¿œã€‚</p>
</blockquote>
<h1 id="bertçš„åŒå‘encoderè¡¨ç¤º">BERTçš„åŒå‘Encoderè¡¨ç¤º</h1>
<p>BERTæ˜¯multi-taskè¯­è¨€æ¨¡å‹ï¼Œå®ƒçš„åŒå‘è¯­è¨€è¡¨ç¤ºä¸»è¦æ˜¯åŸºäºä»¥ä¸‹2ä¸ªtaskå®Œæˆçš„ã€‚</p>
<h2 id="task1maskedè¯­è¨€æ¨¡å‹masked-lmå³å®Œå½¢å¡«ç©ºå¼é¢„æµ‹">Task1ï¼šMaskedè¯­è¨€æ¨¡å‹ï¼ˆmasked LMï¼Œå³å®Œå½¢å¡«ç©ºå¼é¢„æµ‹ï¼‰</h2>
<figure data-type="image" tabindex="15"><img src="https://aprilspring.github.io/post-images/1667020857910.png" alt="" loading="lazy"></figure>
<h2 id="task2next-sentence-predictionå¥å­å…³ç³»é¢„æµ‹">Task2ï¼šNext Sentence Predictionï¼ˆå¥å­å…³ç³»é¢„æµ‹ï¼‰</h2>
<figure data-type="image" tabindex="16"><img src="https://aprilspring.github.io/post-images/1667020874979.png" alt="" loading="lazy"></figure>
<h2 id="multi-task-learningçš„æŸå¤±å‡½æ•°">Multi-task Learningçš„æŸå¤±å‡½æ•°</h2>
<figure data-type="image" tabindex="17"><img src="https://aprilspring.github.io/post-images/1667020891282.png" alt="" loading="lazy"></figure>
<h1 id="bert-vs-gpt-vs-elmo">BERT vs. GPT vs. ELMo</h1>
<p>BERTä¸GPTå’ŒELMoçš„ç›¸åŒå’Œå·®å¼‚ï¼Œå¦‚ä¸‹ï¼š</p>
<figure data-type="image" tabindex="18"><img src="https://aprilspring.github.io/post-images/1667020914070.png" alt="" loading="lazy"></figure>
<h1 id="bertçš„åº”ç”¨">BERTçš„åº”ç”¨</h1>
<h2 id="sequence-level">Sequence-level</h2>
<p>1ï¼‰æˆå¯¹å¥å­åˆ†ç±»ï¼šå¦‚MNLIï¼Œç”¨äºé¢„æµ‹ç¬¬äºŒä¸ªå¥å­ä¸ç¬¬ä¸€ä¸ªå¥å­æ˜¯æ‰¿æ¥å…³ç³»ï¼ŒçŸ›ç›¾å…³ç³»ï¼Œè¿˜æ˜¯ä¸­ç«‹å…³ç³»ï¼Ÿï¼ˆä¸‰åˆ†ç±»è¾“å‡ºï¼Œè„šæœ¬run_classifier.pyï¼‰</p>
<p>2ï¼‰å•ä¸ªå¥å­åˆ†ç±»ï¼šå¦‚CoLAï¼Œç”¨äºåˆ¤å®šç»™å®šè‹±è¯­å¥å­çš„è¯­è¨€å¯æ¥å—æ€§ä¸å¦ï¼Ÿï¼ˆäºŒåˆ†ç±»è¾“å‡ºï¼Œrun_classifier.pyï¼‰ã€‚</p>
<h2 id="token-level">Token-level</h2>
<p>1ï¼‰æ™ºèƒ½é—®ç­”ï¼šå¦‚SQuAD v1.1ï¼ˆThe Standford Question Answering Datasetï¼‰ï¼Œè¯­æ–™ä¸ºæ¥è‡ªWikipediaçš„é—®é¢˜å’ŒåŒ…å«ç­”æ¡ˆçš„æ®µè½ï¼Œç”¨äºä»æ®µè½ä¸­é¢„æµ‹å¯¹åº”ç­”æ¡ˆçš„æ–‡æœ¬è·¨åº¦ï¼ˆå³æ–‡æœ¬è·¨åº¦é¢„æµ‹é—®é¢˜span prediction taskï¼Œè¾“å‡ºä¸ºç­”æ¡ˆçš„Start+End+Spanï¼Œè„šæœ¬run_classifier.pyï¼‰ï¼›</p>
<p>2ï¼‰å‘½åå®ä½“è¯†åˆ«ï¼šå¦‚CoNLL-2003 NERï¼ˆå®ä½“ç±»åˆ«Person, Organization, Location, Miscellaneous, or Other (non-named entity)ï¼‰ï¼Œç”¨äºï¼ˆå³token tagging taskï¼Œè¾“å‡ºï¼šï¼Œè„šæœ¬extract_features.pyï¼‰ã€‚</p>
<figure data-type="image" tabindex="19"><img src="https://aprilspring.github.io/post-images/1667020929322.png" alt="" loading="lazy"></figure>
<h2 id="sentence-encodingembedding">Sentence Encoding/Embedding</h2>
<p>ä½¿ç”¨é¢„è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œç”Ÿæˆå¥å‘é‡ï¼ˆmapping a variable-length sentence to a fixed-length vectorï¼‰ã€‚</p>
<p><a href="https://github.com/hanxiao/bert-as-service">https://github.com/hanxiao/bert-as-service</a></p>
<h2 id="åŸºäºpytorchçš„bertåº”ç”¨">åŸºäºpytorchçš„Bertåº”ç”¨</h2>
<p><a href="https://github.com/codertimo/BERT-pytorch">https://github.com/codertimo/BERT-pytorch</a></p>
<h2 id="pre-train-domain-pre-train-and-fine-tune">Pre-train, domain-pre-train and fine-tune</h2>
<figure data-type="image" tabindex="20"><img src="https://aprilspring.github.io/post-images/1667020945124.png" alt="" loading="lazy"></figure>
<h2 id="pre-trainå‚æ•°">Pre-trainå‚æ•°</h2>
<p>We train with <strong>batch size of 256 sequences</strong> (256 sequences * 512 tokens = 128,000 tokens/batch) for 1,000,000 steps, which is approximately <strong>40 epochs</strong> over the <strong>3.3 billion word corpus</strong>. We use Adam with <strong>learning rate of 1e-4</strong>, Î²1 = 0.9, Î²2 = 0.999, L2 weight decay of 0.01, learning rate warmup over the first 10,000 steps, and linear decay of the learning rate. We use a <strong>dropout probability of 0.1</strong> on all layers. We use a <strong>gelu activation</strong> (Hendrycks and Gimpel, 2016) rather than the standard relu, following OpenAI GPT.</p>
<figure data-type="image" tabindex="21"><img src="https://aprilspring.github.io/post-images/1667021145045.png" alt="" loading="lazy"></figure>
<h2 id="fine-tuneå‚æ•°">Fine-tuneå‚æ•°</h2>
<p>For fine-tuning, most model hyperparameters are the same as in pre-training, with the <strong>exception of the batch size, learning rate, and number of training epochs</strong>. The dropout probability was always kept at 0.1.</p>
<p>!image-20190127000516938](BERTåŸç†å’Œä½¿ç”¨/image-20190127000516938.png)</p>
<figure data-type="image" tabindex="22"><img src="https://aprilspring.github.io/post-images/1667021056288.png" alt="" loading="lazy"></figure>
<p>â€‹</p>
<h1 id="ç‰¹åˆ«é¸£è°¢">ç‰¹åˆ«é¸£è°¢</h1>
<p>https://github.com/google-research/bert</p>
<p>http://nlp.seas.harvard.edu/2018/04/03/attention.html</p>
<p>https://zhuanlan.zhihu.com/p/46833276</p>
<p>https://shimo.im/docs/gmRW4WV2mjoXzKA1/</p>
<p>http://www.52nlp.cn/tag/transformer</p>
<p>https://blog.csdn.net/zuanfengxiao/article/details/78722171</p>
<p>https://yq.aliyun.com/articles/342508</p>
<p>https://www.cnblogs.com/hellcat/p/6925757.html#_label2</p>
<p>https://zhuanlan.zhihu.com/p/38485843</p>
<p>http://jalammar.github.io/illustrated-transformer/</p>
<p>https://zhuanlan.zhihu.com/p/48508221</p>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://aprilspring.github.io/post/zi-ran-yu-yan-chu-li/">
              <h3 class="post-title">
                ä¸‹ä¸€ç¯‡ï¼šè‡ªç„¶è¯­è¨€å¤„ç†
              </h3>
            </a>
          </div>
          
      </div>

      
        
          <div id="gitalk-container"></div>
        

        
      

      <div class="site-footer">
  <div class="slogan">æ¸©æ•…è€ŒçŸ¥æ–°</div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | <a class="rss" href="https://aprilspring.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>



  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '337e2992c146020878cb',
        clientSecret: '883fa6db7cdfafda50356191ec9938e4d661aca1',
        repo: 'AprilSpring.github.io',
        owner: 'AprilSpring',
        admin: ['AprilSpring'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
